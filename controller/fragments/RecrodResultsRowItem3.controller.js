/*
 * Copyright (C) 2009-2018 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["i2d/qm/inspresults/records1/controller/fragments/RecrodResultsRowItemBaseController","i2d/qm/inspresults/records1/util/CalculationHelper","i2d/qm/inspresults/records1/util/NumberFormat","i2d/qm/inspresults/records1/model/formatter"],function(R,C,N,f){"use strict";return R.extend("i2d.qm.inspresults.records1.controller.fragments.RecrodResultsRowItem3",{formatter:f,NumberFormat:N,onSingleValueMultiInputTokenChange:function(e){var F,i,s;var S=e.getSource();var b=S.getBindingContext().getObject()||{};var a=e.getParameter("values");if(e.getParameter("type")==="removed"){F=N.getFloatInstance({decimals:b.Inspspecdecimalplaces});i=a.findIndex(function(c){s=c.toString();c=F.format(F.parse(s));return c===e.getParameter("item").formattedValue;});e.getParameter("values").splice(i,1);}if(a.length){var m=C.calculateMeanValue(a,b.Inspspecsummarizeddcmlplaces);b.Inspectionresultmeanvalue=Number(m);}else{b.Inspectionresultmeanvalue="";}b.InspResultValidValuesNumber=a.length;var u=0;var l=0;a.forEach(function(v){if(b.IsUpper&&v>b.Inspspecupperlimit){u++;}if(b.IsLower&&v<b.Inspspeclowerlimit){l++;}});b.InspRsltAboveToleranceValsNmbr=u;b.InspRsltBelowToleranceValsNmbr=l;b.InspRsltNonconformingValsNmbr=u+l;b.InspResultValidValuesNumber=parseInt(b.InspResultValidValuesNumber||0,10);b.InspRsltNonconformingValsNmbr=parseInt(b.InspRsltNonconformingValsNmbr||0,10);b.to_ResultDetails.results.splice(0,b.to_ResultDetails.results.length);Array.prototype.push.apply(b.to_ResultDetails.results,b.to_ResultDetails.results4Binding);this.precheckAndDataHandleForValuation(b,this.oRRController.Constants.ActionElement.SingleNumber);this.oRRController.handleSaveMap(b,S.getRemovedItems());this.oRRController.refreshBindingFields(S.getModel());},onLiveChange:function(e){var n;n=e.getParameter("newValue");if(n>999999999.99){e.getSource().setValueState("Error");}else{e.getSource().setValueState("None");}}});});
